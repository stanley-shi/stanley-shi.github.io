---
layout: post
title: Ant conditional branch
date: '2010-02-09T11:55:00.001+08:00'
author: Stanley Shi
tags: 
modified_time: '2010-02-09T11:55:09.130+08:00'
blogger_id: tag:blogger.com,1999:blog-4195205503550406237.post-2867262036716820643
blogger_orig_url: http://eng-architect.blogspot.com/2010/02/ant-conditional-branch.html
---

<p>I was working on a auto-build file using ant when I wanted to add some conditional branches in the file. </p>  <p>For example, I want to first check whether the environment variables have been set, if yes, then go on build, if not, just break the current build.</p>  <p>The script is like this:</p>  <p><i>&lt;project name=&quot;Test Project&quot; default=&quot;build&quot;&gt;</i></p>  <p><i></i><i>&lt;property environment=&quot;env&quot; /&gt;</i></p>  <p><i></i><i>&lt;target name=&quot;build&quot; depends=&quot;path.check&quot;&gt;</i></p>  <p><i></i><i>&lt;echo&gt; continue build &lt;/echo&gt;</i></p>  <p><i></i><i>&lt;/target&gt;</i></p>  <p><i></i><i>&lt;target name=&quot;path.check&quot; depends=&quot;checkpath&quot; unless=&quot;all.variable.set&quot;&gt;</i></p>  <p><i></i><i>&lt;echo&gt;env.JAVA_HOME=${env.JAVA_HOME}&lt;/echo&gt;</i></p>  <p><i></i><i>&lt;echo&gt;env.ECLIPSE_HOME=${env.ECLIPSE_HOME}&lt;/echo&gt;</i></p>  <p><i></i><i>&lt;fail message=&quot;not all variables have been set or not set correctly.&quot; /&gt;</i></p>  <p><i></i><i>&lt;/target&gt;</i></p>  <p><i></i><i>&lt;target name=&quot;checkpath&quot;&gt;</i></p>  <p><i></i><i>&lt;condition property=&quot;all.variable.set&quot;&gt;</i></p>  <p><i></i><i>&lt;and&gt;</i></p>  <p><i></i><i>&lt;available file=&quot;${env.JAVA_HOME}&quot; /&gt;</i></p>  <p><i></i><i>&lt;available file=&quot;${env.ECLIPSE_HOME}&quot; /&gt;</i></p>  <p><i></i><i>&lt;/and&gt;</i></p>  <p><i></i><i>&lt;/condition&gt;</i></p>  <p><i></i><i>&lt;/target&gt;</i></p>  <p><i>&lt;/project&gt;</i></p>  <p>The main point of the conditional branch is the &quot;condition&quot; element and the &quot;unless&quot; attribute in the &lt;target&gt;. Please refer to the Apache Ant website for more information.</p>  <p>In this script, we check whether the environment variable &quot;JAVA_HOME&quot; and &quot;ECLIPSE_HOME&quot; have been set, and also check whether the directory exists.</p>  <p>If you only want to test whether this variables have been set, you can change the &lt;condition&gt; block to this:</p>  <p>&lt;condition property=&quot;all.variable.set&quot;&gt;</p>  <p>&lt;and&gt;</p>  <p>&lt;isset property=&quot;env.PROMPT&quot; /&gt;</p>  <p>&lt;isset property=&quot;env.SONIC_HOME&quot; /&gt;</p>  <p>&lt;/and&gt;</p>  <p>&lt;/condition&gt;</p>  <p>For more details about what you can do in the &lt;condition&gt; element, you can check <a href="http://ant.apache.org/manual/CoreTasks/conditions.html">here</a>.</p>  